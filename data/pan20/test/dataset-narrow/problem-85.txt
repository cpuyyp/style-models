iperf can do that job. Just ensure you test your devices back to back first so you know the capabilities of the devices. Of course there are more professional tools as well. This is a good RFC to read up proper methology: $URL$ 

There is no need to put a bandwidth statement on the router (A) interface. If you're doing H-QoS then you shape to 100Mb on the parent, while the child policies then inherit that shaped value. Like so: 

On the left is a Brocade XMR. This is connected via a single gig link to many carriers, in this example BT. BT provide us with many point to point links over this single link at the A end. The B end then segregate and go to each geographically disperse site. On the A end, the XMR port, we specify which site the traffic goes to via a pre agreed upon vlan ID. This all works perfectly fine and we have many of these links to BT and a load of other carriers. The issue mainly is QoS outbound from the XMR. While there is a gig link between my XMR and the carriers, those inner circuits could be anything from 2Mb up to a gig. Let's assume that Customer 1 has a 10Mb link. They want 25% of this link to be reserved for EF marked traffic. This is easy to do outbound on the CPE level as I can shape the interface to 10Mb and then give priority percent 25 to EF marked packets. On the A end however, the XMR considers this entire link to be 1Gb. It doesn't know that vlan 2000 off to Customer site 1 is only 10Mb (BT is policing it to 10Mb within their own network) H-QoS would be ideal as I could shape vlan 2000 to 10Mb, and then within that shaped value give 25% to EF. The issue is that H-QoS on the XMR is only supported on the 8X10Gb module. None of the carriers we use are giving native 10Gb yet straight to us (Just plenty of 1Gb links) My plan is to stick another device between the XMR and the carrier that simply does H-QoS. I've been looking at the Cisco ME3600X which supposedly can do H-QoS based on the vlan ID. Does anyone have experience with this particular feature on the ME3600X or perhaps give me a better idea of doing this? Essentially I would like to have a config that looks sort of like this if it makes more sense: 

The only way to properly do this, if their IP HAS to be the same as their desktop, is for them to RDP onto their desktop over the VPN. Or fix the software that's got this ludicrous requirement 

The reference guide does state that configuring class of service on the main router will work for logical systems: 

Generally you'll want to be using BFD to ensure your forwarding plane is working. If not, you can run IP SLA, to at least two external IPs and fail over if you can't get to both 

Nice thing about the Brocade is that you can convert any tag to another tag, double-tag to another double-tag, double-tag to single-tag, and single-tag to double-tag 

GRF is the global routing and forwarding table. Also known as the default VRF in other vendors. It's simply the regular RIB used when no VRFs are used, or the original VRF when other VRFs are used. A VRF is a virtual routing and forwarding table which allows a physical router to run a 'virutal' router with it's own RIB and FIB and routing protocols. 

You could do this, but you run into all kinds of problems with spanning-tree. Your ports could go into err-disabled. You won't have two separate switches though. The single switch still learns MAC addresses on a port and vlan and that is switch-wide 

You can apply better QoS to the routed ports on the ISRs. QoS on a 'routed aka svi' vlan port on an HWIC-4ESW etc is not as simple 

Yes you can - $URL$ However this is quite rare. It's far more common to do it the other way around with v6 nlri advertised over the v4 connection (used by 6PE and 6VPE) If you're dual-stacked it's far better to simply have a v6 and v4 BGP connection and advertise the correct address families for each 

Are the carriers passing your L2 control frames? Quite often you need to specifically ask them to do so. You can verify by checking your BPDUs sent and received on both switches when they are both up 

It will cause zero disruption. I've done it in the middle of the day before. Any policies will remain, but ignored 

We have used /31s in our core (Brocade, Juniper, Cisco) for over three years with no issues whatsoever. This is a production ISP network, and hence its appropriate to use them in a production environment as long as your kit supports it, and you've tested it 

If you put bandwidth statement on the physical interface you mess up the H-QoS calculation. It's fine for the branches as they are not running H-QoS 

So yes this will work as you expect. This is similar to ipsec where you can only ipsec on the main router, but that still works within a logical system as I noted here: $URL$ 

The route table only shows the live routes. to show all statics you'll need to show what's configured: 

Bigger platforms running IOS-XR, where the FIB gets ditributed to the line cards, also support carrier grade NAT, so it's usefulness is not limited to the LAN alone. Also a lot of Cisco's L3 switches simply do not do NAT at all 

If you used random ports, the user would have to add the correct port numbers each time they went to your site. i.e. www.example.com:80; www.example.com:81; www.example.com:82 etc It would not increase performance to use more ports. The source ports for each connection an ephemeral ports and so different anyway 

90% of the time it makes sense to leave the defaults as-is. But in a high availability environment or large ISP it does make sense to adjust the timers to exactly what you need