About a year ago we implemented WDS and MDT. Using this we have been successfully deploying Windows 7 x86 and x64 on every PC and laptop we have. We put the OS on, then add on Office, Adobe, Antivirus, etc. Also, I have it set to do Windows Updates from our WSUS server. The question I have is, is there anyway to speed the process up or slipstream in some of the updates? It seems that it takes about as long to do the Post Installation Windows Updates as it does the OS and all of the application installs combined. The only thing I can think of is to make a new OS capture with Windows 7 w/SP1 so it doesn't have to install SP1 via the update task. Is there any other way that I might speed this process up? Any suggestions would be greatly appreciated, thanks. 

Others have said online that it works for them, but so far it hasn't for me. It doesn't give an error, it accepts the command just fine, but when I look in ADUC, the groups are still there for the user. Any suggestions as to what I may be doing wrong? Executing from Windows 7 with domain admin rights, Exchange cmdlets and Quest snapin loaded. Thanks! 

I'm wanting to setup alerts for our printers so that when the printer encounters an error, it will send an alert to an email address. Currently we have What's Up Standard, and it looks like you can do this in What's Up Premium. Is there a way that i can use What's Up Standard, or any other tool, to set this up so that when PrinterX is low on Cyan it will send an alert to helpdesk@company.com? Thanks for any help you can give! 

I'm currently trying to setup a task that will email me when the deployment has finished. It seems fairly simple, and I've looked online as a reference. I found one person (Johan I believe) that had a custom ZTISendMail.wsf file that you can install as an application, but even that seems like it's above and beyond what I need. I could be wrong, if so please correct me. What I have is a short .vbs script that when run sends me an SMTP mail. It works from my computer just fine, as well as the deployment server (when double clicked). I've tried placing it on the root of the deployment server, then adding a command line task sequence as the very last step. I've tried with just the command line in there as well as , both give me the same results at the end (failure). I have tried setting "Start in" as C:\ as well to no avail. Am I missing something? This seems like it would be fairly simple to just run the vbs script which would shoot a message off to me. Why is it having a problem running it? Thanks. 

We have just implemented RD Gateway for our own department in preparation for a push to the whole agency for telecommuting. It is all setup and working great, but I was trying to figure out how best to go about monitoring/reporting of users. I see third party software out there that will do it, but is there anything built-in or via powershell/scripting that I could use that would give me a report of the daily activity of users? Something to say, "User A connected at this time, was on for this long, sent/received this much data"? Basically some of the same stuff you can see in event viewer. Ideally I'd like to be able to have this setup so that once a day it emails me with the daily usage for when a supervisor asks about if their person is actually working (or at least online sending and receiving x amount of data), I'll have some metrics to give them. I realize that actual work output is relevant and more of a managerial issue, but I would like to be able to offer as much as I can from my end when asked. Thoughts? Thanks! 

Reset the phone so it was a clean start. Plugged the phone into the wall for network access, plugged my PC into the phone. Plugged the USB cable from the phone into my PC. Starting up it asks if I want to connect via the PC, I tell it next. It prompts on my PC to authenticate via Lync with a box labeled "Logon Information Needed". It has auto-populated my Sign-In address and username. I enter my password and select OK. On the phone it states that it is contacting the time server, this takes about 50 seconds or so. Then it says it is connecting to Lync Server, this takes about 5 seconds. Next it says it is locating the server to download the certificate, this takes about 20 seconds. Then it briefly flashes that it's installing the certificate, then gives me a sign-in error that says: "Cannot sign in. Please verify your sign-in address, domain\user name, and password, and try again. Please verify that the domain entered @domain.com is correct". 

I'm trying to automate the uninstall/install of Office. Removing 2007, installing 2010. I've downloaded the OCT and made changes as I needed. In there I can select, "Remove the following earlier versions of Microsoft Office Programs:" and you can select which to remove (default Remove All), or you can select the option "Default Setup behavior; earlier versions of installed programs are removed." Initially I tried the Default Option, but it gave me the below error. Then I tried manually selecting the second option but leaving them all as "Remove". Same results. I'm trying to get this done via group policy and have downladed and installed the ADM template as well, create a GPO for this OU to test in, etc. Using 2008 Server. I've seen others online with the same error, and instructions are typically "remove the old version first" or use a third party tool (Revo), which I have used in the past with success, but on an individual uninstall/install basis, not via GPO. My end result is for a laptop to boot up on a given day, references the GPO, if it has 2007 it uninstalles 2007 and installs 2010. Here is the error I'm getting, I'm sure it's nothing new as it's fairly prevelant online. 

I've read quite a bit online about this and thought I had found a solution, but it doesn't seem to be working like I would expect. I am wanting to get a user based on the username I input, then remove all groups that it is a member of. Basically the same thing as going into ADUC, selecting the user, selecting the Member Of tab, highlighting everything (except domain users of course) and selecting remove. Here's the command I'm trying to use: 

Currently I have a working MDT 2010 server that has been humming along for awhile with no issues. We've decided to upgrade to Office 2010 and I was trying to layer it into MDT as well. It seems for some reason that it's not using the .msp file saved in the Updates folder during installation. I've found several articles online to verify that I set it up the proper way (or so I think), yet something is still not working. We used to do a full layered approach with MDT. We would install the base OS and then install applications as needed. But, we pretty much have the same programs on every computer so I sysprep and captured a machine when it was up to date. Now with this Office install, I was just wanting to install it via a task sequence like we did on our previous solution (I still have it for reference even and it all appears to be setup the same). I have added the application into the MDT workbench. Created an entry in the task sequence telling it to run the program. I have created a custom .msp file that tells it the key and a few other changes. The .msp file is saved into the updates folder and all appears fine. When I attempt to build a machine, it still prompts me for which version of Office I want instead of picking the ProPlus selection I've specified in the customization file. I can't for the life of me figure out what is stopping it from reading that file. I have tried modifying the .xml file even but it never saves the settings, I'm guessing maybe it doesn't want those settings used if it sees an .msp file in the folder(?). I know this Office and .msp install work as I've manually installed it and had it auto-install via startup script on a dozen end-users, but when using it in MDT it seems to ignore the .msp file. I've also tried to delete and recreate the .msp file in case of corruption. All articles I find online look similar to what I've tried, which is pretty straightforward. Thoughts? Thanks! 

We have a few hundred users and about 40-50 of them need Java for one reason or another. The problem we run into (as have many others online apparently) is that Java seems to want to update all the time. How this differs is that most people online seem to all want to disable automatic updates. I was curious if you could set it to automatically update without prompting the user? Personally I'd not want that because in the past updating Java to the latest and greatest has caused issues with ASDM for me, and this may be the case with other end users' programs as well (or may not). I'm just trying to weigh my options and figure out if this is possible as one less pop-up prompting them to update (when they can't without admin rights) would be great. And, I don't like the idea of ignoring potential security risks, I'd rather update things as they need to be updated. Thanks in advance for your thoughts. 

Currently we have VPN setup on an ASA 5510. I have it set to use NPS for RADIUS authentication, but I've never really configured much as far as accounting. I'm wanting to set this up to be able to tell more of what people are doing/accessing when they are telecommuting. I just have it set up pretty basic right now: 

I am currently having issues with being able to authenticate with RADIUS from our Cisco devices…it seems to partially work but I’m missing something apparently, hoping some experts can point me in the right direction. I have an ASA 5510 and VPN configured on it. I have Windows Server 2008 R2 setup with the NPS role acting as the RADIUS server (only, not using NAP, etc, just setup for RADIUS). I setup VPN recently and it seems to be working fine, but now I’m trying to configure it so that I can use my AD credentials to login to our switches as well, but I can’t get it to divide the two…for instance, all Domain Users can use VPN, but only the NetworkGroup should be able to access the other Cisco devices. Under RADIUS Clients I have created a client named VPN, it has the IP address of our inside interface on the ASA, Device Manufacturer as Cisco and Enabled. I have a client named Switch with the IP address of the switch I’m testing on, Cisco as Device Manufacturer and Enabled. Under Policies > Connection Request Policies there is the default “Use Windows authentication for all users” which only has a Day/Time restriction as a condition but allows access anytime, under settings it has Authentication Provider – Local Computer and Override Authentication Disabled. I’ve added one called VPN (with open time restrictions and IPv4 address condition) and one called Switch (with open time restrictions and IPv4 address condition) here as well, thinking that’s what was needed, but during testing I find that I can disable them and it works just fine…but from reading I read there must be at least one policy in effect. I can disable the default one, but when I setup one of the others with the same credentials it doesn’t seem to take, I can’t login from the switch, I get error “Access denied - Using keyboard-interactive authentication.” If I enable the default CR Policy, it works again right away…basically it seems that it doesn’t care if I have or don’t have a policy in there for each device (and maybe I shouldn’t ?). Under Policies > Network Policies I’ve added two policies as well, one called Switch and one called VPN. The Switch policy is set with the condition of User Groups-Domain\NetworkGroup. Under settings I have: Cisco-AV-Pair with a value of shell:priv-lvl=15. Extended State with a value of blank. Access Permission with a value of Grant Access. Authentication Method with a value of Unencrypted authentication (PAP, SPAP). Nap Enforcement with a value of Allow full network access. Update Noncompliant Clients with a value of True. Service-Type with a value of Login. BAP percentage of Capacity with a value of Reduce Multilink if server reaches 50% for 2 minutes. Some of these settings I set in testing, others were there by default. The VPN policy is set with a condition of User Groups-Domain\DomainUsers. Under settings I have: Ignore User Dial-In Properties with a value of True. Access Permission with a value of Grant Access. Authentication Method with a value of Unencrypted authentication (PAP, SPAP) or MS-CHAP v1 OR MS-CHAP v1, OR MS-CHAPV2. Nap Enforcement with a value of Allow full network access. Update Noncompliant Clients with a value of True. Framed-Protocol with a value of PPP. Service-Type with a value of Framed. Some of these settings aren’t the same because I’ve been going back and forth for a couple of days trying different scenarios, so I’m honestly not sure if some of them are necessary… I do know that if I disable that one default policy under CR-Policy, I can’t login to the switch… if I disable the RADIUS client, I can’t login to the switch (makes sense), but if I disable the Switch Network Policy it still lets me login…assuming it’s just rolling down and taking the credentials from the VPN Network Policy which allows DomainUsers to login, and I’m in that group as well… So the outcome I’m striving for (sorry for such a long question, but trying to be as informative as possible!) is that I would like any of our end users in the DomainUsers AD group to be able to use VPN and dial up successfully, but not allow them to be able to remote into our switches and login the same way. I want only the NetworkGroup AD account to be able to login to those. How can I give access to both, securely? Sounds simple enough, and it looks simple on top but for the life of me it’s not working…if I take away the Switch Policy it still lets an end user (testing with an end user test account) login to my switch with the normal AD login (getting allowed by the VPN policy I assume). Please feel free to ask any questions or clarification, and thanks in advance for any help you can give! 

I'm trying to get a list of all Exchange accounts, format them in descending order from largest mailbox and put that data into an email in HTML format to email to myself. So far I can get the data, push it to a text file as well as create an email and send to myself. I just can't seem to get it all put together. I've been trying to use ConvertTo-Html but it just seems to return data via email like "pageFooterEntry" and "Microsoft.PowerShell.Commands.Internal.Format.AutosizeInfo" versus the actual data. I can get it to send me the right data if i don't tell it to ConvertTo-Html, just have it pipe the data to a text file and pull from it, but it's all ran together with no formatting. I don't need to save the file, i'd just like to run the command, get the data, put it in HTML and mail it to myself. Here's what I have currently: 

Figured out what the problem was. Because I didn't go with the default website, I had to specify in the GPO the port number. Before it wasn't on there (:80) because it was default, a given. Since the reinstall isn't on the default website, I had to place the port in there like so: Original - $URL$ Afterward - $URL$ Hope this helps someone else, thanks! 

I'm working on the well known problem of MDT not wanting to automatically continue because of a legal disclaimer prompt at login. Our disclaimer is set at the domain policy, so I've created a new OU for staging, then blocked inheritance so it doesn't get the GPO. I have MDT set to place the newly built machine in that OU. All of that is fine, the problem is, the machine that I used as my capture machine had the disclaimer locally cached from already being on the network and even being in the proper OU the disclaimer is still there. So I've added a couple lines in MDT to go in and do the following: