I would claim that as it has matured into the modern psychoanalytic and cognitive theories James' stream of consciousness allows for a definition of the self, but does not require it. Actions are perceived as having agents, but those agents are not necessarily individual conscious beings. There is a standard "social psychology" example of a crowd breaking into a riot based upon mutual observation of one another's growing emotionality, without any orchestration or purpose. Who decides that a sports victory requires tearing down parts of buildings, destroying cars or trampling the elderly? Chicago and Edinborough somehow contain meta-beasts within them capable of causing that to happen. "We are so happy that too bad for you." (This is far from unique. I could have chosen Black Friday, but I am down on men today.) This kind of thing is clearly an example of a thing with a narrative following a stream of impressions and acting. But that thing is hardly a 'self', even though there appears to be a 'will' that has decided there should be a riot, how it should spread, and how long it should continue. That will expresses, if anything, more freedom than an individual. Any individual rioting mob member could choose to resist the action. He does not appear to be a mechanism driven deterministically by alcohol and testosterone, incapable of simply stopping. There is an ongoing re-engagement in the process that seems open to random change originating from any participant. And eventually, sanity takes hold of a critical mass of those involved and ends the process. Theories of action that incorporate this perspective, have to see agents of many orders, which appear to have a composite will, but only some of which have a regulating mechanism akin to a self. From this point of view: 1) No, a stream of consciousness does not require a self, and theories of psychological agency have to allow for conscious behavior involving both symbolism and emotion, that is not necessarily centered and guided by an established, unifying structure. 2) Yes, agency still requires an agent. Participation in action requires some attachment to the process or its goal. But that will does not need to be a cohesive and contained agenda that persists across time, it can arise almost randomly and assemble its agenda ad hoc, even if it provides a consistent motivation toward further action. 3) There is no reason to see this diffuse, animal will as being any less free than a centralized and planned one. It is as open to having random factors affect its agenda as any individual, and perhaps more so. Going the opposite direction, toward Daniel Dennett's notion of "Brains made of Cells in Cells", we can see our own intelligence as arising out of a similar sort of mob action, with the freedom resulting from competition for resources within the brain, at a level below consciousness. So the 'how' question is somewhat moot. Free will without a self, happens. And the two may even be inversely related. For traditional psychoanalysts, the self, with its sense of responsibility, may be a force that removes freedom from the will, for its own good. If there is any non-determinism in the world, it probably infects competitive interactions most directly, as they concentrate differences that create advantages -- evolution runs on luck and it mines that luck out of every interaction. If all of our emotional decisions are determined by some competitive interaction, it is wills with structure, not freedom, that are the harder thing to explain. 

I am not sure an evolutionary argument gives a 'reason' in the sense you are asking. If it does, the answer to your questions is "Yes, both." Our strong leanings toward capturing simple symbols is just a hardwired mechanism, but it is shaped that way for a reason. Most of modern experimental psychology would say that we reach out for symbols, and we capture them and then fit them into a context. (Though it requires a very broad sense of 'symbol'.) Our perception does not receive data passively and collate it, but instead projects forward assumptions to meet the incoming data half-way. For instance, we begin to have emotional reactions before we identify their causes, and then shape the emotional experience to fit the cause. We screen out highly intrusive, obvious and outright scary data when we are acutely focused on something difficult. Most strikingly to me, we invent object permanence. If we see identical things in two different places in our vision too quickly in succession, we see them as the same thing, we invent a continuous path between them in our vision, and we remember it as real. If the objects are seen in different orientations or in different colors, we think we can remember the exact point in our visual field where 'it' changed color or flipped over, even though 'it' was two different objects, and neither of them was ever in that position. One way to make sense of this is via evolution. It makes sense that a general reasoning method evolved from a system originally tuned to a narrow range of targets or threats, sought or avoided situations, and not from some more general mechanism that just 'tried to make sense' of the world. As we developed subtler, less pointed goals, we began to see symbols instead of threats or targets. We started to piece our stimuli together into more and more complete packages, and to be less intensely motivated by specific details most of the time. But the basic methodology of scanning for known objects still dominates its structure. So the theory is that we are not born to learn how to notice two "x" marks as the same thing, but we are born to learn things like how to know two ripe apples as the same thing, or two prowling cats as the same thing, and we have leveraged that for more general purposes. Once you become attached to this, it is hard to see how other ways learning might evolve would be anywhere near as efficient. It is clearly not the only way of thinking. Many of our more artificial, explicit ways of thinking work directly opposite to this, trying to get the overall sense and not attach to detail or goal first. Resisting the impulse to pre-judge is a primary path to fairness, and whole religions have grow up with that focus. But it seems likely that most of the ways evolution would lead to a brain, would contain some aspect of this bias, since focus on danger is a basic mechanism for survival. At the risk of continually over-promoting the same book, "Consciousness, Explained" contains this data and the argument much more detail. Dennett lays it out as motivation for his favorite theory of learning, and to make counterarguments to older theories.