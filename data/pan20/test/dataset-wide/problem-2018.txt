Lots of good answers here but I think there's another aspect to this that you aren't considering. You got a job that was supposed to be a programming job but wasn't and then you turned it into one. That, my friend, is called 'success'. You found an escape route out of the trap of a dead-end job. But now, instead of parlaying your achievement into a real satisfying career, you are considering squandering it? This won't last forever. At some point this company and/or this legacy system will no longer be around. And then what? You put on your resume that you were a spreadsheet jockey for X years or do you tell them that you actually are a programmer but haven't been doing anything because you never told your employer what you were doing? I'm a father too so I get that spending time with your son is important but you also have a life. I think you are wasting your talents and this will ultimately make you less happy. You work remote now. There are tons of jobs on SO that allow remote work. I think not telling your employer is the worst choice you can make here. At the very least they should employ you long enough to integrate this solution into the actual application. For your own good, you probably shouldn't admit to doing nothing for any significant length of time. 

Believing you are the only one who can do your job and then trying to tell your employer that while asking for a raise or other benefits is a quick way to find out you really are replaceable, even if it causes them some pain. Instead of "you can't survive without me", try "look, I'm doing all this work and I think my output speaks for itself, would you be open to negotiating a raise"? I've been in both sides of this argument, where I had employees think that they were irreplaceable, offered ultimatums, and found themselves replaced. I've also been in the "I don't think they can do it without me" side and found myself replaced. Tout your accomplishments and value, not their failures without you, you will get a lot further. 

I think the other answers are great but would like to add that you should show an opportunity for improvement. Not only explain what you did, but make suggestions as to how to make it better... For example, your email should include something like: 

Depending on how the organization is structured, this can be a difficult situation because the manager is in a position of power. In some companies (e.g. Google, from what I read) it's normal for people at lower levels in the organization to push back hard on management. If you are in a company with a more traditional stratified power structure, it's probably not the best option to directly challenge the manager. If this is a concern and it seems like it is, you will probably need to get help for your manager. Explain the situation and convince them that it is leading to issues with their team's performance i.e. your ability to deliver. If your manager is a peer or senior to the manager in question, they can address this. If not, they will need to look up the chain of leadership for assistance. Your manager may know what to do immediately. If not, suggest they attend the meeting and make sure the agenda is followed. This should prevent the other manager from monopolizing the meeting. 

This is not about what you believe about software copyright, software ownership and your respect about copyright laws. Dura lex sed lex: by adding this code in the codebase of the new company you expose them to potential lawsuits. You say that nobody will find out - this also confirms that you recognize it's fishy - but that's not your decision to make, the same way a recruiter cannot chose to discriminate against brunettes and arguing that nobody will find out. 

I think you sample size is too small - 4 successful personal interviews are not enough to conclude that you always pass it. It also depends on what you count as a personal interview: it is often that it will be ridiculously easy or not focus on technical skills at all - they could just want to weed out crazy/completely incompetent applicants. I also disagree with your conclusion that they are not testing the skills that match their tasks merely because the questions were not original: they think that the type of candidate that would successfully solve these tasks is most likely to succeed in the day-to-day work, and coming up with truly original and effective questions that also reflect common tasks can be quite challenging. Having said that, you might want to prepare a bit and study the type of questions you get asked if only to ensure that you don't fail because you panic/are too surprised. But I don't think that having a mindset of "I should sit down and study for hours to pass the stupid test" helps - interviewing processes are highly non-deterministic! Just keep going and perhaps try to find positions that better fit your current abilities. Again, interviewing is very random! 

The "Thank you for your reply" is a nicety to start an email that is going to be very disappointing. 

We've been given a number to hire somebody, we offered you what we thought was a fair offer but you replied stating our offer is not adequate. We do not feel that negotiating is going to be productive, and we have a candidate that meets our requirements that is willing to accept a salary in our budget. 

You are technically qualified for the positions we hire for. If something comes up in the future we would be happy to interview you again. But do note: they now know your perceived worth relative to what they need, and may not be so quick to interview you for a position in the same salary range as the one you applied for. And in case it still isn't clear, the entire email pretty much reduces to: Thank you for your time but we've decided to go with a different candidate. So yes, it means they retracted their offer and rejected your counter-offer. They probably took 2 days to reply to you so they could contact the next candidate and see if they would accept what they were offering. If you want to try and reply and say "wait, I'll take what you've offered", then you are welcome to try. They've probably already keyed up the next choice so if you are going to accept, don't wait, do it now. The company is probably not going to retract an offer to another candidate because you've said you want the job now. 

The problem here is that the approach the customer is proposing is backwards and awkward. The IT team should be asking you for guidance on how to resolve the issue. You trying to navigate their internal IT department and find someone to do this is obnoxious for you and them. The person you are in touch with is confused about how things work. Instead of making it into a battle around what is and isn't your job, just guide them on how to get things done. "Please work with your IT team to contact me(/my team) with regards to this problem. I will provide them with the information they need to resolve this issue. Thanks." Once you get someone who knows something and can do something about it, things should go more smoothly. NOTE: It's of some concern that you have access to their servers if it's not your job to administrate them. If you don't administer these servers, you do not need access and therefore should not have it from a security perspective. 

Verbal agreements are only worth the paper they are written on. If you still want the 3rd job, go back to them and say 

I skimmed a lot of it but as I understand it your situation is that you have a good opportunity but people from your past are making it difficult to secure a position. You say that the person has offered you some project work, take it. Prove the quality of your work and when you are done ask for more. If you do work for him, do it well, and he keeps wanting to give you more, he'll listen less and less to those other people and more to your experience. Rebuilding a reputation can be difficult, especially when you have multiple people working against you. It seems you have somebody willing to give you a chance, so take it and run with it. It allows the hiring manager to test you out without making a full commitment. Yes, this takes time, but in the end puts you in a much better bargaining position. Right now if you were to beg for a job, and even if he could convince others in the organization to hire you on, you would be under a very uncomfortable microscope for quite some time. Taking some project based work removes that microscope for you, and the overall risk for them. I would take the work, but I would take it based on the going rate of an independent contractor with the same skills. You want to make yourself look like a bargain if hired, and if not, get paid well for your work. 

Again, I can't imagine a company taking the risk to save a couple of days of work. Besides, I'd be thrilled to have a chance to rewrite any piece of code - improving the architecture, better tests etc. Perhaps this time start it as an open source project (doesn't have to be on personal time either as it's not rare for companies to have open source projects) - that way you'll avoid having the same dilemma in the future and potentially help others. 

You don't have a formal offer. You don't have a conditional offer. He didn't even confirm that there will be an offer. Even if we assume that he has your best interests at heart, it is quite likely that he cannot make the hiring decision and has to stall till the hiring committee makes a decision and any background checks have been completed. Even if you get a verbal confirmation it's not going to matter. At this point you can either: 1. take the risk of rejecting offer B in hopes of getting a (satisfactory) offer from A 2. try to get an extension of the deadline from company B 3. take offer B and accept that you might have missed an offer from A While I'd personally go for offer B, only you can evaluate the risks and rewards and deduce what's the best choice. Oh, and 

Etc... This way you are not only showing that you took the appropriate action based on the available information but you noticed an opportunity to improve the existing system and support. As a manager I never liked hearing problems without having suggestions about how to solve them. I hired people because they could perform the job, and if they have an issue performing the job I didn't want to hear "I did my best", I wanted to hear "this is how we do it better". 

The worst that would happen is they say "sorry, we can't match that" and you then decide whether its worth to go with the lower salary or tell them that you'd rather accept a position with better pay. 

Yes, they can ask you this, and depending on the country you live in, there is no legal reason why they couldn't use your answers against you, however I'm not sure why they would. Having a part time job while in school is a good thing. Having a part time job when you're out of school and not trying for a full time one is a red flag. I can't think of any legitimate reason why the number of hours you worked at a previous job would be basis for denial, unless you can't work the hours you are interviewing for.